import{_ as e,u as a,r as l,o as t,a as s,b as o,c as r,d as n,e as c,f as i,i as u,g as d,t as m,l as p,w as f,h as _,j as b,k as v,E as w,m as g,n as h,F as q,p as y,q as T}from"./index-9e27afd7.js";import{F as k}from"./FullLoading-248942d7.js";import{V as P}from"./ValidateText-c3a47b08.js";import{h as x}from"./useValidate-1451d16f.js";import{S as R,r as F,u as V}from"./xlsx-1ee80fa6.js";import{U as C}from"./UploadFiles-8f77d823.js";import"./search-ad5cf249.js";import"./loading-f40b77db.js";const N={key:0,class:"flex"},j=e({__name:"ReqrName",setup(e){const u=a(),d=l(localStorage.getItem("userId")),m=l({});return t((async()=>{m.value=await u.fetchUserInfo(d.value),u.setReqr(m.value)})),(e,a)=>{const l=s("el-input");return o(x)(o(m))?(r(),n("span",N,[c(l,{modelValue:o(m).name,"onUpdate:modelValue":a[0]||(a[0]=e=>o(m).name=e),disabled:""},null,8,["modelValue"])])):i("v-if",!0)}}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/coreTeam/components/ReqrName.vue"]]),I={class:"flex"},S=e({__name:"PgrName",setup(e){const t=l(""),d=l({}),m=e=>{d.value=e,t.value=e.name,a().setPgr(d.value)};return(e,a)=>{const l=s("el-input");return r(),n("span",I,[i(" 顯示 Programmer name 框 "),c(l,{modelValue:o(t),"onUpdate:modelValue":a[0]||(a[0]=e=>u(t)?t.value=e:null),disabled:""},null,8,["modelValue"]),i(" 選擇 Programmer button 與搜尋對話框 "),c(o(R),{dept:"IT",onGetUserInfo:m})])}}},[["__scopeId","data-v-411d3adc"],["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/coreTeam/components/PgrName.vue"]]),W={class:"ce-title-lg"},U={class:"mt-3 mb-8"},A=e({__name:"index",setup:e=>(e,a)=>{const l=s("el-col"),t=s("el-row"),u=s("el-form-item");return r(),n("div",null,[d("span",W,m(o(p)("Define core team member")),1),d("div",U,[i(" Requester name "),c(u,{label:o(p)("Requester name")},{default:f((()=>[c(t,{class:"form-row-width"},{default:f((()=>[c(l,{span:12},{default:f((()=>[c(j)])),_:1})])),_:1})])),_:1},8,["label"]),i(" IT name "),c(u,{label:o(p)("IT name")},{default:f((()=>[c(t,{class:"form-row-width"},{default:f((()=>[c(l,{span:12},{default:f((()=>[c(S)])),_:1}),c(l,{span:12},{default:f((()=>[c(o(P),{"key-outer":"coreTeam","key-inner":"pgr"})])),_:1})])),_:1})])),_:1},8,["label"])])])}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/coreTeam/index.vue"]]),E={href:"/application/template.xlsx",class:"ce-link",download:"it-req-template"},z=d("br",null,null,-1),B=e({__name:"Notice",setup:e=>(e,a)=>{const l=s("el-alert");return r(),_(l,{type:"info",title:o(p)("How to fill out this form?"),"show-icon":"",closable:!1},{default:f((()=>[b(m(o(p)("You can download"))+" ",1),d("a",E,m(o(p)("template file")),1),b(" "+m(o(p)(", then upload it after you complete it")),1),z,b(" "+m(o(p)("Without uploading the template, you can complete these fields then submit it")),1)])),_:1},8,["title"])}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/reqTable/components/Notice.vue"]]),G=e({__name:"PrintReqTable",emits:["get-need-refresh"],setup(e,{emit:t}){const n=l(null),i=a(),u=t,d=e=>{n.value.clearFiles(),e.raw=null,i.setReqTable({reqName:"",stage:"",customer:"",device:"",tester:"",equipment:"",system:"",purpose:""}),u("get-need-refresh",!0)},g=(e,a)=>{n.value.clearFiles();const l=e[0];l.uid=v(),n.value.handleStart(l)},h=e=>{if(!e.raw)return;let a=e.raw,l=new FileReader;l.onloadend=a=>{let t=l.result,s=F(t,{type:"array"}),o=s.SheetNames,r=s.Sheets[o];V.sheet_to_json(r);for(let l=2;l<=9;l++)if(void 0===r[V.encode_cell({r:l,c:3})])return w.error(p("You have not completed the request table yet")),void d(e);i.setReqTable({reqName:r[V.encode_cell({r:2,c:3})].v,stage:r[V.encode_cell({r:3,c:3})].v,customer:r[V.encode_cell({r:4,c:3})].v,device:r[V.encode_cell({r:5,c:3})].v,tester:r[V.encode_cell({r:6,c:3})].v,equipment:r[V.encode_cell({r:7,c:3})].v,system:r[V.encode_cell({r:8,c:3})].v,purpose:r[V.encode_cell({r:9,c:3})].v}),u("get-need-refresh",!0)},l.readAsArrayBuffer(a)};return(e,a)=>{const l=s("el-button"),t=s("el-upload"),i=s("el-form-item");return r(),_(i,{label:o(p)("Upload excel"),class:"block"},{default:f((()=>[c(t,{ref_key:"uploadRef",ref:n,limit:1,"on-remove":d,"auto-upload":!1,"on-exceed":g,"on-change":h,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},{trigger:f((()=>[c(l,{type:"primary",plain:""},{default:f((()=>[b(m(`${o(p)("Select file")}...`),1)])),_:1})])),_:1},512)])),_:1},8,["label"])}}},[["__scopeId","data-v-ddcda982"],["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/reqTable/components/PrintReqTable.vue"]]),O=e({__name:"ManualReqTable",props:{refreshCode:{type:Number,default:0}},setup(e){const i=a(),u=l({}),d=e,m={reqName:{label:"Request name",type:"textarea",rows:"1"},stage:{label:"Stage"},customer:{label:"Customer"},device:{label:"Device"},tester:{label:"Tester"},equipment:{label:"Equipment"},system:{label:"System"},purpose:{label:"Purpose",type:"textarea",rows:"5"}},_=e=>i.setReqTable(u.value);return t((()=>u.value=i.getReqTable)),g(d,(e=>u.value=i.getReqTable)),(e,a)=>{const l=s("el-input"),t=s("el-col"),i=s("el-row"),d=s("el-form-item");return r(),n(q,null,h(m,((e,a)=>c(d,{key:a,label:o(p)(e.label)},{default:f((()=>[c(i,{class:"form-row-width"},{default:f((()=>[c(t,{span:12},{default:f((()=>[c(l,{modelValue:o(u)[a],"onUpdate:modelValue":e=>o(u)[a]=e,type:e.type,rows:e.rows,onChange:_},null,8,["modelValue","onUpdate:modelValue","type","rows"])])),_:2},1024),c(t,{span:12},{default:f((()=>[c(o(P),{"key-outer":"reqTable","key-inner":a},null,8,["key-inner"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["label"]))),64)}}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/reqTable/components/ManualReqTable.vue"]]),D=e({__name:"PlantRadios",setup(e){const n=a(),i=l("");return t((()=>i.value=n.getPlant)),g(i,(e=>n.setPlant(i.value))),(e,a)=>{const l=s("el-radio"),t=s("el-radio-group"),n=s("el-col"),d=s("el-row"),m=s("el-form-item");return r(),_(m,{label:o(p)("Plant")},{default:f((()=>[c(d,{class:"form-row-width"},{default:f((()=>[c(n,{span:12},{default:f((()=>[c(t,{modelValue:o(i),"onUpdate:modelValue":a[0]||(a[0]=e=>u(i)?i.value=e:null)},{default:f((()=>[c(l,{label:"P1",size:"small",class:"pl-2"},{default:f((()=>[b("P1")])),_:1}),c(l,{label:"P2",size:"small"},{default:f((()=>[b("P2")])),_:1}),c(l,{label:"P3",size:"small"},{default:f((()=>[b("P3")])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(n,{span:12},{default:f((()=>[c(o(P),{"key-outer":"reqTable","key-inner":"plant"})])),_:1})])),_:1})])),_:1},8,["label"])}}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/reqTable/components/PlantRadios.vue"]]),L={class:"ce-title-lg"},M={class:"p-3"},Y={class:"mt-3 mb-8"},H=e({__name:"index",setup(e){const u=a(),_=l(0),b=l([]),v=e=>{e&&_.value++},w=async e=>{b.value=Object.assign([],e),u.setAttachedFiles(b.value)};return t((()=>u.setAttachedFiles(b.value))),(e,a)=>{const l=s("el-form-item");return r(),n("div",null,[d("span",L,m(o(p)("Fill the request table")),1),i(" 提示 alert "),d("div",M,[c(o(B))]),i(" 填 Request table 可以有兩種方式:  "),d("div",Y,[i(" 1. 讀 .xlsx 檔填表 "),c(o(G),{onGetNeedRefresh:v}),i(" 2. 手動輸入各項欄位 "),c(o(O),{"refresh-code":o(_)},null,8,["refresh-code"]),i(" 再來選擇此需求是哪個廠 "),c(o(D)),i(" 上傳附件 "),c(l,{label:o(p)("Attached files")},{default:f((()=>[c(o(C),{size:"small",plain:true,onGetChildren:w})])),_:1},8,["label"])])])}}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/reqTable/index.vue"]]),$={class:"add-new-submit-container"},J=e({__name:"SubmitButton",setup(e){const t=a(),i=y(),u=l(!1),d=async()=>{await t.checkEmpty(!1),await _()},_=async()=>{const e=await t.getValidate;let a=!1;for await(const[l,s]of Object.entries(e))for await(const[e,o]of Object.entries(s)){const l=t.getBenefitType;if(a=""===o,""!==o){switch(e){case"pgr":window.scrollTo({top:0,behavior:"smooth"});break;case"reqName":case"stage":case"customer":{const e="Efficiency"===l?510:560;window.scrollTo({top:e,behavior:"smooth"});break}case"device":case"tester":case"equipment":case"system":case"purpose":case"plant":{const e="Efficiency"===l?840:880;window.scrollTo({top:e,behavior:"smooth"});break}}return}}a&&await v()},v=async()=>{u.value=!0;const e=T.service({lock:!0,text:p("Loading"),background:"rgba(168, 171, 178, 0.3)"});setTimeout((async()=>{await t.submitApplication()?(w.success(p("New a IT-Request successfully")),i.replace({path:"/tables"})):(w.error(p("Failed to new a IT-Request")),i.push({path:"/reload"})),e.close(),u.value=!1}),2e3)};return(e,a)=>{const l=s("el-button");return r(),n("div",$,[c(l,{type:"primary",loading:o(u),onClick:d},{default:f((()=>[b(m(o(p)("Submit")),1)])),_:1},8,["loading"])])}}},[["__scopeId","data-v-20d5f3c4"],["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/components/SubmitButton.vue"]]),K={id:"addnew-container",class:"ce-main-container"},Q={key:0},X=e({__name:"index",setup(e){const a=l(!1);return t((async()=>{a.value=!0,setTimeout((()=>a.value=!1),1500)})),(e,l)=>{const t=s("el-form");return r(),n("div",K,[c(o(k),{loading:o(a)},null,8,["loading"]),o(a)?i("v-if",!0):(r(),n("div",Q,[c(t,{"label-width":"150px"},{default:f((()=>[i(" Core team members "),c(o(A)),i(" Request table "),c(o(H))])),_:1}),i(" Submit button "),c(o(J))]))])}}},[["__file","C:/Program Files/Workspace/it-req-fe/src/views/add-new/index.vue"]]);export{X as default};
